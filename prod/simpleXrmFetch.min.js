var simpleXrmFetch={fetch:function(n){var t="<fetch version='1.0' output-format='xml-platform' mapping='logical'",i;return t+=n.distinct?" distinct='true'":" distinct='false'",n.aggregate&&(t+=" aggregate='true'"),t+=">",i="<\/fetch>",n.entity&&(t+="<entity name='"+n.entity+"'>",i="<\/entity>"+i),n.attributes&&n.attributes.length>0&&(t+=simpleXrmFetch.attributes(n.attributes)),n.order&&n.order.length>0&&(t+=simpleXrmFetch.order(n.order)),n.filter&&(t+=simpleXrmFetch.filter(n.filter)),n.linkEntity&&(t+=simpleXrmFetch.linkEntity(n.linkEntity)),t+i},attributes:function(n){var i="",t;if(n.length>0)for(t=0;t<n.length;t++)i+="<attribute name='"+n[t].name+"'",!n[t].alias||(i+=" alias='"+n[t].alias+"'"),!n[t].aggregate||(i+=" aggregate='"+n[t].aggregate+"'"),i+=" />";return i},order:function(n){var i="",t;if(n&&n.length>0)for(n.length>2&&(n=n.slice(0,2)),t=0;t<n.length;t++)i+="<order attribute='"+n[t].attribute+"'",i+=n[t].descending?" descending='true'":" descending='false'",i+=" />";return i},filter:function(n){var t="",e="",i,r,f,u;if(n){if(n.type&&n.conditions&&n.conditions.length>0){for(t+="<filter type='"+n.type+"'>",e+="<\/filter>",i=0;i<n.conditions.length;i++)if(r=n.conditions[i],r.attribute&&r.operator)if(t+="<condition attribute='"+r.attribute+"' operator='"+n.conditions[i].operator+"'",r.operator==="in"||r.operator==="not-in"){if(r.values){for(t+=">",f=0;f<r.values.length;f++)u=r.values[f],t+="<value",u.uiname&&(t+=" uiname='"+u.uiname+"'"),u.uitype&&(t+=" uitype='"+u.uitype+"'"),t+=">",u.value&&(t+=u.value),t+="<\/value>";t+="<\/condition>"}}else n.conditions[i].uiname&&(t+=" uiname='"+n.conditions[i].uiname+"'"),n.conditions[i].uitype&&(t+=" uitype='"+n.conditions[i].uitype+"'"),n.conditions[i].value&&(t+=" value='"+n.conditions[i].value+"'"),t+="/>";n.filter&&(t+=simpleXrmFetch.filter(n.filter))}return t+e}},linkEntity:function(n){var i=[],r=[],u=[],t;if(n&&n.length>0)for(t=0;t<n.length;t++)n[t].name&&n[t].from&&n[t].to&&(i[t]="<link-entity name='"+n[t].name+"' from='"+n[t].from+"' to='"+n[t].to+"'",r[t]="<\/link-entity>",n[t].visible===!1&&(i[t]+=" visible='false'"),n[t].intersect&&(i[t]+=" intersect='true'"),n[t].alias&&(i[t]+=" alias='"+n[t].alias+"'"),i[t]+=">",n[t].attributes&&n[t].attributes.length>0&&(i[t]+=simpleXrmFetch.attributes(n[t].attributes)),n[t].filter&&(i[t]+=simpleXrmFetch.filter(n[t].filter)),n[t].linkEntity&&(i[t]+=simpleXrmFetch.linkEntity(n[t].linkEntity)),u.push(i[t].toString()+r[t].toString()));return u.join("")},addCustomFilter:function(n){Xrm.Page.getControl(n.control).addCustomFilter(n.filter,n.entityType)},addCustomView:function(n){var t="";t=n.viewId?simpleXrm.wrapGuid(n.viewId):simpleXrm.newBracedGuid();Xrm.Page.getControl(n.control).addCustomView(t,n.entityType,n.viewDisplayName,n.fetchXml,n.layoutXml,n.isDefault)},addPreSearch:function(n){Xrm.Page.getControl(n.control).addPreSearch(n.preSearchHandler)}};