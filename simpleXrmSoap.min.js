var simpleXrmSoap={encodeXML:function(n){var t=[],r;for(i=0;i<n.length;i++){r=n.charAt(i);switch(r){case"<":t.push("&lt;");break;case">":t.push("&gt;");break;case"&":t.push("&amp;");break;case'"':t.push("&quot;");break;case"'":t.push("&#39;");break;default:r<" "||r>"~"?t.push("&#"+r.charCodeAt(0)+";"):t.push(r)}}return t.join("")},decodeXML:function(n){return typeof n!="string"&&(n=n.toString()),n},request:function(n){var i=Xrm.Page.context.getClientUrl()+"/XRMServices/2011/Organization.svc/web",t;if(window.XMLHttpRequest)t=new XMLHttpRequest;else if(window.ActiveXObject)t=new ActiveXObject("Microsoft.XMLHTTP");else return simpleXrm.error("We encountered an unexpected issue. Please check your form data before proceeding. Info for Admin: User's browser may not support one of the requested scripts. Please attempt using FireFox or IE 8+"),null;t.open("POST",encodeURI(i),!1);t.setRequestHeader("Accept","application/xml, text/xml, */*");t.setRequestHeader("Content-Type","text/xml; charset=utf-8");t.setRequestHeader("SOAPAction","http://schemas.microsoft.com/xrm/2011/Contracts/Services/IOrganizationService/Execute");t.onreadystatechange=n.callback;t.send(n.request)},normalizeResults:function(n){return n.responseText&&(window.DOMParser?(parser=new DOMParser,xmlDoc=parser.parseFromString(n.responseText,"text/xml")):(xmlDoc=new ActiveXObject("Microsoft.XMLDOM"),xmlDoc.async=!1,xmlDoc.loadXML(n.responseText))),xmlDoc},getRetrieveMultipleResults:function(n){var i,n,u,t,r;if(simpleXrmSoap.parseOnReady(n)){if(i=null,n.responseXML&&(n=n.responseXML,n.childNodes&&(n=n.childNodes[0],n.localName==="Envelope"&&n.childNodes&&(n=n.childNodes[0],n.localName==="Body"&&n.childNodes&&(n=n.childNodes[0],n.localName==="ExecuteResponse"&&n.childNodes&&(n=n.childNodes[0],n.localName==="ExecuteResult"&&n.childNodes&&(u=n.childNodes[0],t=n.childNodes[1],u.localName==="ResponseName"&&u.textContent==="RetrieveMultiple"&&t.childNodes&&t.childNodes.length===1&&t.childNodes[0].childNodes)))))))for(i=[],r=0;r<t.childNodes[0].childNodes.length;r++)i.push(simpleXrmSoap.normalizeResults(t.childNodes[0].childNodes[r]));return i}},parseFetchResponse:function(n){var o,t,u,i,r,f,e;if(n.childNodes&&n.childNodes.length===1&&(n=n.childNodes[0],n.childNodes&&n.childNodes.length===1&&(n=n.childNodes[0],n.childNodes&&n.childNodes.length===1&&(n=n.childNodes[0],n.childNodes&&n.childNodes.length===1&&(n=n.childNodes[0],n.childNodes&&n.childNodes[0]&&n.childNodes.length===2&&n.childNodes&&n.childNodes[0]&&n.childNodes[0].childNodes&&n.childNodes[0].childNodes[0]&&n.childNodes[0].childNodes[0].nodeValue==="RetrieveMultiple"&&(n=n.childNodes[1],n.childNodes&&n.childNodes[0]&&(n=n.childNodes[0],n.childNodes[1]&&n.childNodes[1].childNodes&&n.childNodes[0].childNodes[0].nodeValue==="EntityCollection"&&(n=n.childNodes[1],n.childNodes&&n.childNodes[0]&&(n=n.childNodes[0],n.childNodes))))))))){for(o=[],t=0;t<n.childNodes.length;t++){for(u={attributes:{},id:n.childNodes[t].childNodes[3].childNodes[0].nodeValue,logicalName:n.childNodes[t].childNodes[4].childNodes[0].nodeValue,relatedEntities:[]},i=0;i<n.childNodes[t].childNodes[0].childNodes.length;i++)f=n.childNodes[t].childNodes[0].childNodes[i].childNodes[0].childNodes[0].nodeValue,e=n.childNodes[t].childNodes[0].childNodes[i].childNodes[1].childNodes[0].nodeValue,u.attributes[f]=simpleXrm.parseValue(e);for(r=0;r<n.childNodes[t].childNodes[2].childNodes.length;r++)f=n.childNodes[t].childNodes[2].childNodes[r].childNodes[0].childNodes[0].nodeValue,e=n.childNodes[t].childNodes[2].childNodes[r].childNodes[1].childNodes[0].nodeValue,u.attributes[f]=simpleXrm.parseValue(e);o.push(u)}return o}},getFetchResults:function(n){if(simpleXrmSoap.parseOnReady(n)){var t=simpleXrmSoap.normalizeResults(n);return simpleXrmSoap.parseFetchResponse(t)}},retrieveMultiple:function(n){var t=simpleXrmSoap.encodeXML(n.fetch),i;t=t.replace(/\"/g,"'");i="<?xml version=\"1.0\" encoding=\"utf-8\"?><s:Envelope xmlns:s=\"http://schemas.xmlsoap.org/soap/envelope/\"><s:Body><RetrieveMultiple xmlns='http://schemas.microsoft.com/crm/2007/WebServices'><query xmlns:q1='http://schemas.microsoft.com/crm/2006/Query' xsi:type='q1:QueryExpression'>"+n.query+"<\/query><\/RetrieveMultiple><\/s:Body><\/s:Envelope>";simpleXrmSoap.request({request:i,callback:n.callback})},fetch:function(n){var t=simpleXrmSoap.encodeXML(n.fetch),i;t=t.replace(/\"/g,"'");i="<s:Envelope xmlns:s='http://schemas.xmlsoap.org/soap/envelope/'><s:Body><Execute xmlns='http://schemas.microsoft.com/xrm/2011/Contracts/Services'><request i:type='b:RetrieveMultipleRequest' xmlns:b='http://schemas.microsoft.com/xrm/2011/Contracts' xmlns:i='http://www.w3.org/2001/XMLSchema-instance'><b:Parameters xmlns:c='http://schemas.datacontract.org/2004/07/System.Collections.Generic'><b:KeyValuePairOfstringanyType><c:key>Query<\/c:key><c:value i:type='b:FetchExpression'><b:Query>"+t+"<\/b:Query><\/c:value><\/b:KeyValuePairOfstringanyType><\/b:Parameters><b:RequestId i:nil='true' /><b:RequestName>RetrieveMultiple<\/b:RequestName><\/request><\/Execute><\/s:Body><\/s:Envelope>";simpleXrmSoap.request({request:i,callback:n.callback})},retrieveDependentComponents:function(n){var t='<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"><s:Body><Execute xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" xmlns:i="http://www.w3.org/2001/XMLSchema-instance"><request i:type="b:RetrieveDependenciesForDeleteRequest" xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts" xmlns:b="http://schemas.microsoft.com/crm/2011/Contracts"><a:Parameters xmlns:c="http://schemas.datacontract.org/2004/07/System.Collections.Generic"><a:KeyValuePairOfstringanyType><c:key>ObjectId<\/c:key><c:value i:type="d:guid" xmlns:d="http://schemas.microsoft.com/2003/10/Serialization/">'+n.id+'<\/c:value><\/a:KeyValuePairOfstringanyType><a:KeyValuePairOfstringanyType><c:key>ComponentType<\/c:key><c:value i:type="d:int" xmlns:d="http://www.w3.org/2001/XMLSchema">1<\/c:value><\/a:KeyValuePairOfstringanyType><\/a:Parameters><a:RequestId i:nil="true" /><a:RequestName>RetrieveDependenciesForDelete<\/a:RequestName><\/request><\/Execute><\/s:Body><\/s:Envelope>';simpleXrmSoap.request({request:t,callback:n.callback})},setStatus:function(n){var t='<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"><s:Body><Execute xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" xmlns:i="http://www.w3.org/2001/XMLSchema-instance"><request i:type="b:SetStateRequest" xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts" xmlns:b="http://schemas.microsoft.com/crm/2011/Contracts"><a:Parameters xmlns:c="http://schemas.datacontract.org/2004/07/System.Collections.Generic"><a:KeyValuePairOfstringanyType><c:key>EntityMoniker<\/c:key><c:value i:type="a:EntityReference"><a:Id>'+n.record.id+"<\/a:Id><a:LogicalName>"+n.record.entityName+'<\/a:LogicalName><a:Name i:nil="true" /><\/c:value><\/a:KeyValuePairOfstringanyType><a:KeyValuePairOfstringanyType><c:key>State<\/c:key><c:value i:type="a:OptionSetValue"><a:Value>'+n.stateCode+'<\/a:Value><\/c:value><\/a:KeyValuePairOfstringanyType><a:KeyValuePairOfstringanyType><c:key>Status<\/c:key><c:value i:type="a:OptionSetValue"><a:Value>'+n.statusCode+'<\/a:Value><\/c:value><\/a:KeyValuePairOfstringanyType><\/a:Parameters><a:RequestId i:nil="true" /><a:RequestName>SetState<\/a:RequestName><\/request><\/Execute><\/s:Body><\/s:Envelope>';simpleXrmSoap.request({request:t,callback:n.callback})},parseOnReady:function(n){var t=!1;return n.readyState===4&&n.status===200&&(n.onreadystatechange=null,t=!0),t},runWorkflow:function(n){var t='<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/"><s:Body><Execute xmlns="http://schemas.microsoft.com/xrm/2011/Contracts/Services" xmlns:i="http://www.w3.org/2001/XMLSchema-instance"><request xmlns:a="http://schemas.microsoft.com/xrm/2011/Contracts"><a:Parameters xmlns:b="http://schemas.datacontract.org/2004/07/System.Collections.Generic"><a:KeyValuePairOfstringanyType><b:key>EntityId<\/b:key><b:value i:type="d:guid" xmlns:d="http://schemas.microsoft.com/2003/10/Serialization/">'+n.target.id+'<\/b:value><\/a:KeyValuePairOfstringanyType><a:KeyValuePairOfstringanyType><b:key>WorkflowId<\/b:key><b:value i:type="d:guid" xmlns:d="http://schemas.microsoft.com/2003/10/Serialization/">'+n.workflow.id+'<\/b:value><\/a:KeyValuePairOfstringanyType><\/a:Parameters><a:RequestId i:nil="true" /><a:RequestName>ExecuteWorkflow<\/a:RequestName><\/request><\/Execute><\/s:Body><\/s:Envelope>';simpleXrmSoap.request({request:t,callback:n.callback})}};
//# sourceMappingURL=simpleXrmSoap.min.js.map
